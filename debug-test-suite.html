<!DOCTYPE html>
<html>
<head>
    <title>LIFT Docs AJAX Debug Test</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; background: #f9f9f9; }
        .result { padding: 10px; margin: 10px 0; background: #fff; border: 1px solid #ddd; }
        .error { background: #ffebee !important; color: #c62828; }
        .success { background: #e8f5e8 !important; color: #2e7d32; }
        pre { background: #f5f5f5; padding: 10px; font-size: 12px; overflow-x: auto; }
        button { padding: 10px 15px; margin: 5px; cursor: pointer; }
        .info { background: #e3f2fd; color: #1976d2; }
    </style>
</head>
<body>
    <h1>LIFT Docs AJAX Debug Test</h1>
    
    <div class="test-section">
        <h2>Step 1: Check Test Files</h2>
        <button onclick="checkTestFiles()">Check Test Files</button>
        <div id="test-files-result" class="result" style="display:none;"></div>
    </div>
    
    <div class="test-section">
        <h2>Step 2: Test Nonce System</h2>
        <button onclick="testNonce()">Test Nonce</button>
        <div id="nonce-result" class="result" style="display:none;"></div>
    </div>
    
    <div class="test-section">
        <h2>Step 3: Test AJAX Actions Registration</h2>
        <button onclick="testAjaxActions()">Test AJAX Actions</button>
        <div id="ajax-actions-result" class="result" style="display:none;"></div>
    </div>
    
    <div class="test-section">
        <h2>Step 4: Test Simple AJAX Request</h2>
        <button onclick="testSimpleAjax()">Test Simple AJAX</button>
        <div id="simple-ajax-result" class="result" style="display:none;"></div>
    </div>
    
    <div class="test-section">
        <h2>Step 5: Test Full Search Users AJAX</h2>
        <button onclick="testSearchUsersAjax()">Test Search Users AJAX</button>
        <div id="search-users-result" class="result" style="display:none;"></div>
    </div>

    <script>
    function showResult(containerId, content, type = 'info') {
        var $container = $('#' + containerId);
        $container.removeClass('error success info').addClass(type);
        $container.html(content).show();
    }
    
    function checkTestFiles() {
        showResult('test-files-result', 'Checking test files...', 'info');
        
        var files = [
            'test-nonce.php',
            'test-ajax-actions.php', 
            'test-ajax-simple.php'
        ];
        
        var baseUrl = window.location.href.replace(/\/[^\/]*$/, '/');
        var results = [];
        var completed = 0;
        
        files.forEach(function(file) {
            $.get(baseUrl + file)
                .done(function(data) {
                    results.push(file + ': <span style="color: green;">✓ Available</span>');
                })
                .fail(function() {
                    results.push(file + ': <span style="color: red;">✗ Not accessible</span>');
                })
                .always(function() {
                    completed++;
                    if (completed === files.length) {
                        showResult('test-files-result', 
                            '<h3>Test Files Status:</h3><ul><li>' + 
                            results.join('</li><li>') + '</li></ul>', 'info');
                    }
                });
        });
    }
    
    function testNonce() {
        showResult('nonce-result', 'Testing nonce system...', 'info');
        
        var baseUrl = window.location.href.replace(/\/[^\/]*$/, '/');
        $.get(baseUrl + 'test-nonce.php')
            .done(function(data) {
                showResult('nonce-result', '<h3>Nonce Test Results:</h3>' + data, 'success');
            })
            .fail(function(xhr) {
                showResult('nonce-result', '<h3>Nonce Test Failed:</h3><pre>' + xhr.responseText + '</pre>', 'error');
            });
    }
    
    function testAjaxActions() {
        showResult('ajax-actions-result', 'Testing AJAX actions registration...', 'info');
        
        var baseUrl = window.location.href.replace(/\/[^\/]*$/, '/');
        $.get(baseUrl + 'test-ajax-actions.php')
            .done(function(data) {
                showResult('ajax-actions-result', '<h3>AJAX Actions Test Results:</h3>' + data, 'success');
            })
            .fail(function(xhr) {
                showResult('ajax-actions-result', '<h3>AJAX Actions Test Failed:</h3><pre>' + xhr.responseText + '</pre>', 'error');
            });
    }
    
    function testSimpleAjax() {
        showResult('simple-ajax-result', 'Testing simple AJAX...', 'info');
        
        var baseUrl = window.location.href.replace(/\/[^\/]*$/, '/');
        $.get(baseUrl + 'test-ajax-simple.php')
            .done(function(data) {
                showResult('simple-ajax-result', '<h3>Simple AJAX Test Results:</h3>' + data, 'success');
            })
            .fail(function(xhr) {
                showResult('simple-ajax-result', '<h3>Simple AJAX Test Failed:</h3><pre>' + xhr.responseText + '</pre>', 'error');
            });
    }
    
    function testSearchUsersAjax() {
        showResult('search-users-result', 'Testing search users AJAX directly...', 'info');
        
        // Get AJAX URL
        var ajaxUrl = '<?php echo admin_url("admin-ajax.php"); ?>';
        
        // This won't work from static HTML, but will show the concept
        showResult('search-users-result', 
            '<h3>Direct AJAX Test:</h3>' +
            '<p>Cannot test directly from static HTML. Please use the test-ajax-simple.php file instead.</p>' +
            '<p><strong>AJAX URL:</strong> ' + ajaxUrl + '</p>', 'info');
    }
    </script>
</body>
</html>
